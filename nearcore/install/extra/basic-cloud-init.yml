#cloud-config
hostname: test-neard-ubuntu20
swap: 
  filename: /swap
  size: "auto" 
  maxsize: 12000000000
mounts:
  - [ /swap swap swap defaults 0 0 ]
package_update: true
package_upgrade: true
packages:
  - apt-transport-https
  - ca-certificates
  - gnupg-agent
  - software-properties-common
  - squashfs-tools
  - snapd
  - debian-keyring 
  - curl
  - python3
  - python3-pip
  - jq
groups:
  cloud-users: []
users:
  - name: crypto-solutions
    gecos: Builder 
    homedir: /home/crypto-solutions
    passwd: [  ] # Use mkpasswd
    no_user_group: false
    primary_group: crypto-solutions
    sudo: ALL=(ALL) NOPASSWD:ALL
    groups: [ users, cloud-users, adm, audio, cdrom, video, plugdev, dip, sys, netdev ]
    shell: /bin/bash
    inactive: false
    ssh_authorized_keys:
      - ssh-rsa   # You need this
    lock_passwd: false 
    uid: 1000
write_files:
  - encoding: b64
  # This is a customized sshd_config to set the following settings for the ssh daemon..  
  # Protocol = 2  Root remote login = no   No password Auth, Only pubky auth, Pam is enabled Stronger Encryption
    content: IyAgICAgICAkT3BlbkJTRDogc3NoZF9jb25maWcsdiAxLjEwMSAyMDE3LzAzLzE0IDA3OjE5OjA3IGRqbSBFeHAgJAoKIyBUaGlzIGlzIHRoZSBzc2hkIHNlcnZlciBzeXN0ZW0td2lkZSBjb25maWd1cmF0aW9uIGZpbGUuICBTZWUKIyBzc2hkX2NvbmZpZyg1KSBmb3IgbW9yZSBpbmZvcm1hdGlvbi4gCiMgaHR0cHM6Ly9tYW4ub3BlbmJzZC5vcmcvc3NoZF9jb25maWcKIyBUaGlzIHNzaGQgd2FzIGNvbXBpbGVkIHdpdGggUEFUSD0vdXNyL2JpbjovYmluOi91c3Ivc2Jpbjovc2JpbgojIFRoZSBzdHJhdGVneSB1c2VkIGZvciBvcHRpb25zIGluIHRoZSBkZWZhdWx0IHNzaGRfY29uZmlnIHNoaXBwZWQgd2l0aAojIE9wZW5TU0ggaXMgdG8gc3BlY2lmeSBvcHRpb25zIHdpdGggdGhlaXIgZGVmYXVsdCB2YWx1ZSB3aGVyZQojIHBvc3NpYmxlLCBidXQgbGVhdmUgdGhlbSBjb21tZW50ZWQuICBVbmNvbW1lbnRlZCBvcHRpb25zIG92ZXJyaWRlIHRoZQojIGRlZmF1bHQgdmFsdWUuCiMKIyBUaGlzIGlzIGEgbW9kaWZpZWQgdmVyc2lvbiBvZiBkZWZhdWx0IGNvbmZpZyBob3BlZnVsbHkgaXQgd2lsbCBwcm92aWRlIGJldHRlciBzZWNydWl0eSAKIyBhcyB3ZWxsIGFzIGJldHRlciBmaXQgb3VyIHVzZSBjYXNlLgojCiMgRG9jdW1lbnRhdGlvbiAtLT4gaHR0cHM6Ly93d3cub3BlbnNzaC5jb20vbWFudWFsLmh0bWwgCgojIEhlcmUgd2UgdXBncmFkZSB0aGUgc3NoIHByb3RvY29sIGFuZCBjYW4gZGVmaW5lIHBvcnQgYW5kIGlwClByb3RvY29sIDIKUG9ydCAyMgojQWRkcmVzc0ZhbWlseSBhbnkKI0xpc3RlbkFkZHJlc3MgMC4wLjAuMAoKIyBTSEEtMSB1c2UgaXMgcXVlc3Rpb25hYmxlIGZyb20gYSBzZWN1cml0eSBwZXJzcGVjdGl2ZSAgIAojIEZ1cnRoZXIgUmVhZGluZyAtLT4gaHR0cHM6Ly9jc3JjLm5pc3QuZ292L3Byb2plY3RzL2hhc2gtZnVuY3Rpb25zL25pc3QtcG9saWN5LW9uLWhhc2gtZnVuY3Rpb25zIAojIEZ1cnRoZXIgUmVhZGluZyAtLT4gaHR0cHM6Ly93d3cuc3NoLmNvbS9jcnlwdG9ncmFwaHkvCiMKIyBTdXBwb3J0ZWQgSG9zdEtleSBhbGdvcml0aG1zIGJ5IG9yZGVyIG9mIHByZWZlcmVuY2UuCkhvc3RLZXkgL2V0Yy9zc2gvc3NoX2hvc3RfZWQyNTUxOV9rZXkKSG9zdEtleSAvZXRjL3NzaC9zc2hfaG9zdF9yc2Ffa2V5Ckhvc3RLZXkgL2V0Yy9zc2gvc3NoX2hvc3RfZWNkc2Ffa2V5CgojIFNwZWNpZnkga2V5IGV4Y2hhbmdlIGFsZ29yaXRobXMgCktleEFsZ29yaXRobXMgY3VydmUyNTUxOS1zaGEyNTZAbGlic3NoLm9yZyxlY2RoLXNoYTItbmlzdHA1MjEsZWNkaC1zaGEyLW5pc3RwMzg0LGVjZGgtc2hhMi1uaXN0cDI1NixkaWZmaWUtaGVsbG1hbi1ncm91cC1leGNoYW5nZS1zaGEyNTYKIyBTcGVjaWZ5IENpcGhlcnMKQ2lwaGVycyBhZXMyNTYtY3RyLGFlczE5Mi1jdHIsYWVzMTI4LWN0cixjaGFjaGEyMC1wb2x5MTMwNUBvcGVuc3NoLmNvbSxhZXMyNTYtZ2NtQG9wZW5zc2guY29tLGFlczEyOC1nY21Ab3BlbnNzaC5jb20KIyBTcGVjaWZ5IE1lc3NhZ2UgYXV0aGVudGljYXRpb24gY29kZSBhbGdvcml0aG1zIApNQUNzIGhtYWMtc2hhMi01MTIsaG1hYy1zaGEyLTI1NixobWFjLXNoYTItNTEyLWV0bUBvcGVuc3NoLmNvbSxobWFjLXNoYTItMjU2LWV0bUBvcGVuc3NoLmNvbQoKIyBSZWtleUxpbWl0IFNwZWNpZmllcyB0aGUgbWF4aW11bSBhbW91bnQgb2YgZGF0YSB0aGF0IG1heSBiZSB0cmFuc21pdHRlZCBiZWZvcmUgdGhlIHNlc3Npb24ga2V5IGlzIHJlbmVnb3RpYXRlZCwgCiMgb3B0aW9uYWxseSBmb2xsb3dlZCBhIG1heGltdW0gYW1vdW50IG9mIHRpbWUgdGhhdCBtYXkgcGFzcyBiZWZvcmUgdGhlIHNlc3Npb24ga2V5IGlzIHJlbmVnb3RpYXRlZAojIEkndmUgc2V0IGl0IHRvIDIgaG91cnMgYW5kIGxldCB0aGUgY2lwaGVyIGhhbmRsZSB0aGUgZGF0YQojIGh0dHBzOi8vbWFuLm9wZW5ic2Qub3JnL3NzaGRfY29uZmlnI1Jla2V5TGltaXQKUmVrZXlMaW1pdCBkZWZhdWx0IDJoCgojIExvZ2dpbmcgCiMgVGhlIHBvc3NpYmxlIHZhbHVlcyBhcmU6IERBRU1PTiwgVVNFUiwgQVVUSCwgTE9DQUwwLCBMT0NBTDEsIExPQ0FMMiwgTE9DQUwzLCBMT0NBTDQsIExPQ0FMNSwgTE9DQUw2LCBMT0NBTDcuIFRoZSBkZWZhdWx0IGlzIEFVVEguClN5c2xvZ0ZhY2lsaXR5IEFVVEgKIyBUaGUgcG9zc2libGUgdmFsdWVzIGFyZTogUVVJRVQsIEZBVEFMLCBFUlJPUiwgSU5GTywgVkVSQk9TRSwgREVCVUcsIERFQlVHMSwgREVCVUcyLCBhbmQgREVCVUczLiBUaGUgZGVmYXVsdCBpcyBJTkZPIApMb2dMZXZlbCBWRVJCT1NFCgojIExPR0lOIAojCkxvZ2luR3JhY2VUaW1lIDNtClBlcm1pdFJvb3RMb2dpbiBubwpTdHJpY3RNb2RlcyB5ZXMKTWF4QXV0aFRyaWVzIDYKCiMgTXVsdGlwbGUgc2Vzc2lvbnMgbWF5IGJlIGVzdGFibGlzaGVkIGJ5IGNsaWVudHMgdGhhdCBzdXBwb3J0IGNvbm5lY3Rpb24gbXVsdGlwbGV4aW5nLgojIFRoZSBtYXhpbXVtIG51bWJlciBvZiBvcGVuIHNoZWxsLCBsb2dpbiBvciBzdWJzeXN0ZW0gKGUuZy4gc2Z0cCkgc2Vzc2lvbnMgcGVybWl0dGVkIHBlciBuZXR3b3JrIGNvbm5lY3Rpb24KTWF4U2Vzc2lvbnMgMTAKCgojIEFVVEhFTlRJQ0FUSU9OCiMKIyBQZXJtaXQgYXV0aGl0aWNhdGlvbiB2aWEgUHVia2V5PwpQdWJrZXlBdXRoZW50aWNhdGlvbiB5ZXMKIyBUbyBkaXNhYmxlIHR1bm5lbGVkIGNsZWFyIHRleHQgcGFzc3dvcmRzLCBjaGFuZ2UgdG8gbm8gaGVyZSEKUGFzc3dvcmRBdXRoZW50aWNhdGlvbiBubwojIERvIHdlIHJlYWxseSB3YW50IHRvIGFsbG93IGVtcHR5IHBhc3N3b3Jkcz8KUGVybWl0RW1wdHlQYXNzd29yZHMgbm8KIyBDaGFuZ2UgdG8geWVzIHRvIGVuYWJsZSBjaGFsbGVuZ2UtcmVzcG9uc2UgcGFzc3dvcmRzIChiZXdhcmUgaXNzdWVzIHdpdGgKIyBzb21lIFBBTSBtb2R1bGVzIGFuZCB0aHJlYWRzKQpDaGFsbGVuZ2VSZXNwb25zZUF1dGhlbnRpY2F0aW9uIG5vCiMgSWYgeW91IGp1c3Qgd2FudCB0aGUgUEFNIGFjY291bnQgYW5kIHNlc3Npb24gY2hlY2tzIHRvIHJ1biB3aXRob3V0CiMgUEFNIGF1dGhlbnRpY2F0aW9uLCB0aGVuIGVuYWJsZSB0aGlzIGJ1dCBzZXQgUGFzc3dvcmRBdXRoZW50aWNhdGlvbgojIGFuZCBDaGFsbGVuZ2VSZXNwb25zZUF1dGhlbnRpY2F0aW9uIHRvICdubycuClVzZVBBTSB5ZXMKCiMgaHR0cHM6Ly9tYW4ub3BlbmJzZC5vcmcvc3NoLWFnZW50LjEKIyB5ZXMgPSAodGhlIGRlZmF1bHQpIGFsbG93cyBzc2gtYWdlbnQgdG8gZm9yd2FyZCBpbmZvCiMgbm8gPSBkb2VzIG5vdCBhbGxvdyBzc2gtYWdlbnQgdG8gZnVuY3Rpb24KQWxsb3dBZ2VudEZvcndhcmRpbmcgeWVzCgojIHllcyA9ICh0aGUgZGVmYXVsdCkgb3IgYWxsIHRvIGFsbG93IFRDUCBmb3J3YXJkaW5nLCAKIyBubyA9IHByZXZlbnQgYWxsIFRDUCBmb3J3YXJkaW5nLCAKIyBsb2NhbCA9IGFsbG93IGxvY2FsIChmcm9tIHRoZSBwZXJzcGVjdGl2ZSBvZiBzc2goMSkpIGZvcndhcmRpbmcgb25seQojIHJlbW90ZSA9IGFsbG93IHJlbW90ZSBmb3J3YXJkaW5nIG9ubHkKQWxsb3dUY3BGb3J3YXJkaW5nIHllcwoKIyBHYXRld2F5UG9ydHMgPSB3aGV0aGVyIHJlbW90ZSBob3N0cyBhcmUgYWxsb3dlZCB0byBjb25uZWN0IHRvIHBvcnRzIGZvcndhcmRlZCBmb3IgdGhlIGNsaWVudC4gCkdhdGV3YXlQb3J0cyBubwoKWDExRm9yd2FyZGluZyBubwojWDExRGlzcGxheU9mZnNldCAxMAojWDExVXNlTG9jYWxob3N0IHllcwpQZXJtaXRUVFkgeWVzClByaW50TW90ZCBubwpQcmludExhc3RMb2cgeWVzCiMgVENQS2VlcEFsaXZlIGlzIHNwb29mYWJsZSBzbyBpdHMgZGlzYWJsZWQKVENQS2VlcEFsaXZlIG5vCgojIERJU0NPTk5FQ1QgSU5BQ1RJVkUgQ0xJRU5UUwojIHNzaGQgd2lsbCBzZW5kIGEgImNsaWVudCBhbGl2ZSBtZXNzYWdlIiBldmVyeSA1IG1pbnV0ZXMgaWYgbm8gcmVzcG9uc2UgYWZ0ZXIgNiBtZXNzYWdlcyAoMzAgbWludXRlcykgdGhlbiB0aGUgY2xpZW50IGlzIGRpc2Nvbm5lY3RlZApDbGllbnRBbGl2ZUludGVydmFsIDMwMApDbGllbnRBbGl2ZUNvdW50TWF4IDYKCiMgTWF4U3RhcnR1cHMgLSBTcGVjaWZpZXMgdGhlIG1heGltdW0gbnVtYmVyIG9mIGNvbmN1cnJlbnQgdW5hdXRoZW50aWNhdGVkIGNvbm5lY3Rpb25zIHRvIHRoZSBTU0ggZGFlbW9uLiBUaGUgZGVmYXVsdCBpcyAxMDozMDoxMDAKTWF4U3RhcnR1cHMgMTA6MzA6MTAwCgojIFNTSCBUdW5uZWxpbmcgZW5hYmxlZCBvciBub3QKUGVybWl0VHVubmVsIHllcwoKIyBTcGVjaWZpZXMgdGhlIHBhdGhuYW1lIG9mIGEgZGlyZWN0b3J5IHRvIGNocm9vdCgyKSB0byBhZnRlciBhdXRoZW50aWNhdGlvbgpDaHJvb3REaXJlY3Rvcnkgbm9uZQoKIyBTcGVjaWZpZXMgd2hhdCBlbnZpcm9ubWVudCB2YXJpYWJsZXMgc2VudCBieSB0aGUgY2xpZW50IHdpbGwgYmUgY29waWVkIGludG8gdGhlIHNlc3Npb24ncyBlbnZpcm9uLgpBY2NlcHRFbnYgTEFORyBMQ18qCgojIG92ZXJyaWRlIGRlZmF1bHQgb2Ygbm8gc3Vic3lzdGVtcyAKU3Vic3lzdGVtIHNmdHAgL3Vzci9saWIvb3BlbnNzaC9zZnRwLXNlcnZlcgoKI1VzZUxvZ2luIG5vCiNQZXJtaXRVc2VyRW52aXJvbm1lbnQgbm8KI0NvbXByZXNzaW9uIGRlbGF5ZWQKI1BpZEZpbGUgL3Zhci9ydW4vc3NoZC5waWQKIyBTcGVjaWZpZXMgYWRkaXRpb25hbCB0ZXh0IHRvIGFwcGVuZCB0byB0aGUgU1NIIHByb3RvY29sIGJhbm5lciAKI1ZlcnNpb25BZGRlbmR1bSBub25lCiMgU3BlY2lmaWVzIG5vIGRlZmF1bHQgYmFubmVyIHBhdGguLi4gICBleGFtcGxlID0gL2V0Yy9zc2gvYmFubmVyCiNCYW5uZXIgbm9uZQojIFVzZUROUyAtIFNwZWNpZmllcyB3aGV0aGVyIHNzaGQgc2hvdWxkIGxvb2sgdXAgdGhlIHJlbW90ZSBob3N0IG5hbWUuIFRoaXMgdGFrZXMgdGltZSBhbmQgcmVzb3VyY2VzIHdpdGggbGl0dGxlIGJlbmVmaXQuCiNVc2VETlMgbm8KIyBFeGFtcGxlIG9mIG92ZXJyaWRpbmcgc2V0dGluZ3Mgb24gYSBwZXItdXNlciBiYXNpcwojIE1hdGNoIFVzZXIgYW5vbmN2cwojICAgICAgIFgxMUZvcndhcmRpbmcgbm8KIyAgICAgICBBbGxvd1RjcEZvcndhcmRpbmcgbm8KIyAgICAgICBQZXJtaXRUVFkgbm8KIyAgICAgICBGb3JjZUNvbW1hbmQgY3ZzIHNlcnZlcgojICAgICAgIFBhc3N3b3JkQXV0aGVudGljYXRpb24geWVzCg==
    owner: root:root
    path: /etc/ssh/sshd_config
    permissions: '0644'
  - encoding: b64
  # This is the bash script we will run on first boot
    content: 
    owner: root:root
    path: /user/local/bin/install.sh
    permissions: '0644'  
runcmd:
  - sudo apt-get remove docker docker-engine docker.io containerd runc
  - curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
  - sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"
  - sudo apt-get update && sudo apt-get install docker-ce docker-ce-cli containerd.io
  - sudo install.sh
